const mongoose=require("mongoose"),Schema=mongoose.Schema,nodemailer=require("nodemailer"),ContactSchema=new Schema({fname:{type:String,Required:[!0,"Please input a first name"]},lname:{type:String,Required:[!0,"Please input a last name"]},email:{type:String,Required:[!0,"Please input an email address"],lowercase:!0},message:{type:String,Required:[!0,"Please input a message"]}});ContactSchema.post("save",async function(){const{fname:e,lname:s,email:o,message:a}=this,n=nodemailer.createTransport({host:"smtp.gmail.com",port:465,secure:!0,auth:{user:process.env.gmailUser,pass:process.env.gmailPass}});n.verify(function(e,s){e?console.log("HERE IS THE ERROR\n",e):console.log("Server is ready to take our messages")});const t={from:"Your sender info here",to:process.env.gmailUser,subject:"New message from contact form at bavlifyweb.com",text:`${e} ${s} (${o}) says: ${a}`};n.sendMail(t,(e,s)=>{e?console.log("Email couldn't be sent\n",e):console.log("Email sent successfully")})});const contact=mongoose.model("contact",ContactSchema);module.exports=contact;